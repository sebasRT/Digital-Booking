import React, { useCallback, useContext, useEffect, useMemo, useState } from 'react'
import { CategoryCard } from './CategoryCard';
import "../../styles/Categories.css"
import Select from 'react-select'
import { CategoriesFilter } from './CategoriesFilter';
import { Link } from 'react-router-dom';
import { GlobalContext } from '../../assets/global.context';



const filter =(c,handle,categ)=> 
        <div className="filter" >
          <h2  style={{fontSize:"1.4rem",color:"#263238"}}>Buscar por tipo de alojamiento: </h2>
          <Select className='selector' placeholder={c} options={categ} onChange={handle}></Select>
          <Link to="/products" className='showAll'><button>mostrar todos</button></Link>
        </div>;



export const Categories = () => {
  
const [category, setCategorie] = useState(0)
const [filter2, setFilter2] =  useState(<CategoriesFilter></CategoriesFilter>);
const {categories} = useContext(GlobalContext);
const categoriesJSON = categories;


  const categ = Object.keys(categoriesJSON).map(cat => ({
    value: categoriesJSON[cat].idcategorias,
    label: categoriesJSON[cat].titulo
  }));
//   return categ
// }, [])


const handleCategory =useCallback( e =>{
  const classNames = e.target.className.split(" ");
  const category = classNames[0]
  setCategorie(category)
  console.log(category);},[])


const handleCategory2 = useCallback(e=>{setCategorie(e.target.className)},[])

useEffect(() => {
  setFilter2(<CategoriesFilter cate={category}></CategoriesFilter>)
  console.log(category);
}, [category])





switch (category) {
  case 0:
    return ( 
    
      <div className='categories'>
        <div className='cb'>

        <h2 style={{fontSize:"1.4rem",color:"#263238"}}>Buscar por tipo de alojamiento: </h2>
        <Link to="/products" className='showAll'><button>mostrar todos los productos</button></Link>
        </div>
      <div className='categories-container' >
  
          {Object.keys(categoriesJSON).map(cat=>{const cate = categoriesJSON[cat];
          return(
        
              <CategoryCard key={cate.idcategorias} id={cate.idcategorias} img={cate.url_imagen} description={cate.description} numbers={cate.numbers} name={cate.titulo} onClick={handleCategory}></CategoryCard>
              )})
          }
      </div>
  
  </div>
    )
;  
    break;
case 1:
return (<div className='cont'>
  {filter("Hoteles",handleCategory2,categ)}
  {filter2}
</div>
  )
    break;

case 2:
  return(<div className='cont'>
    {filter("Apartamentos",handleCategory2,categ)}
    {filter2}
  </div>
    
  )
    break;

case 3:
  return(
    <div className='cont'>{filter("Hosteles",handleCategory2,categ)} {filter2}</div>
    
  )
    break;

case 4:
  return(
    <div className='cont'>{filter("Bed & Breakfast",handleCategory2,categ)} {filter2}</div>
  )
    break;
  default:
    break;
}
  

}
